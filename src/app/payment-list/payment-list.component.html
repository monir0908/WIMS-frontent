<block-ui>
    <div class="row">

        <div class="col-lg-12">
            <div class="row">
                <div class="col-lg-12">
                    <div class="card card-border-primary">
                        <div class="card-header">
                            <h5>Payment List </h5>
                            <button [routerLink]="['/receive-payment']" class="btn btn-info btn-sm float-right"> Receive Payment </button>
                        </div>
                        <div class="card-block ">
                          <div class="row">
                            <div class="col-lg-7">
                              <div class="form-group row">
                                <div class="col-sm-12">
                                  <input type="text" class="form-control" placeholder="Search by customer,Payment No, Bill No, Session" (keyup)="filterSearch($event)" />
                                  <!-- <div *ngIf="submitted && f.customer.errors" class="error-text">
                                    <span *ngIf="f.customer.errors.required" class="text-danger"> Member is required</span>

                                </div> -->
                                </div>
                              </div>
                            </div>
                          </div>
                            <div class="row">
                                <div class="col-lg-12 ">
                                 <ngx-datatable #table class="material table-bordered" [rows]="paymentList" [loadingIndicator]="loadingIndicator"
                                  [columnMode]="ColumnMode.force" [headerHeight]="40" [footerHeight]="50" [scrollbarH]="true"  [externalPaging]="true"
                                  rowHeight="auto" [count]="page.totalElements" [offset]="page.pageNumber" [limit]="page.size"
                                  (page)="setPage($event)">

                                  <ngx-datatable-column [width]="100" name="Payment No" prop="id" [draggable]="false" [sortable]="false">
                                    <ng-template let-value="value" ngx-datatable-cell-template>
                                        <span > {{ value }} </span>
                                    </ng-template>
                                </ngx-datatable-column>
                                  <ngx-datatable-column [width]="100" name="Bill No" prop="bill" [draggable]="false" [sortable]="false">
                                    <ng-template let-value="value" ngx-datatable-cell-template>
                                        <span > {{ value }} </span>
                                    </ng-template>
                                </ngx-datatable-column>
                                  <ngx-datatable-column [width]="200" name="Customer" prop="customer" [draggable]="false" [sortable]="false">
                                      <ng-template let-value="value" ngx-datatable-cell-template>
                                          <span > {{ value }} </span>
                                      </ng-template>
                                  </ngx-datatable-column>
                                  <ngx-datatable-column [width]="100" name="Session" prop="session" [draggable]="false" [sortable]="false">
                                      <ng-template let-value="value" ngx-datatable-cell-template>
                                          <span > {{ value }} </span>
                                      </ng-template>
                                  </ngx-datatable-column>

                                  <ngx-datatable-column [width]="100" name="Discount" prop="discount" [draggable]="false" [sortable]="false">
                                      <ng-template let-value="value" ngx-datatable-cell-template>
                                          <span > {{ value }} </span>
                                      </ng-template>
                                  </ngx-datatable-column>

                                  <ngx-datatable-column [width]="150" name="Paid Amount" prop="paid_amount" [draggable]="false" [sortable]="false">
                                      <ng-template let-value="value" ngx-datatable-cell-template>
                                          <span > {{ value }} </span>
                                      </ng-template>
                                  </ngx-datatable-column>


                                  <ngx-datatable-column [width]="150" name="Payment Method" prop="payment_method" [draggable]="false" [sortable]="false">
                                      <ng-template let-value="value" ngx-datatable-cell-template>
                                          <span> <strong class="label label-info">{{ PaymentType[value] }} </strong></span>
                                          <!-- <span *ngIf="value === 2"> <strong class="label label-primary">{{ PaymentType[value] }} </strong></span> -->
                                      </ng-template>
                                  </ngx-datatable-column>

                                  <ngx-datatable-column [width]="150" name="Remarks" prop="remarks" [draggable]="false" [sortable]="false">
                                      <ng-template let-value="value" ngx-datatable-cell-template>
                                          <span > {{ value }} </span>
                                      </ng-template>
                                  </ngx-datatable-column>


                                 <!-- <ngx-datatable-column [width]="100" name="Is Payment Checked" prop="id"  [draggable]="false" [sortable]="false">
                                      <ng-template let-row="row" ngx-datatable-cell-template>
                                          <span > {{ row.is_payment_checked }} </span>
                                      </ng-template>
                                  </ngx-datatable-column> -->

                                 <!--  <ngx-datatable-column [width]="120" name="Is Payment Finally Checked"  [draggable]="false" [sortable]="false">
                                      <ng-template let-row="row" ngx-datatable-cell-template>
                                          <span > {{ row.is_payment_checked_finally }} </span>
                                      </ng-template>
                                  </ngx-datatable-column> -->


                                  <ngx-datatable-column [cellClass]="'text-center '" [width]="160" name="Payment Checked" [draggable]="false"
                                  [sortable]="false">
                                  <ng-template let-row="row" ngx-datatable-cell-template>
                                    <span (click)="paymentCheck(row,1)" *ngIf="!row.is_payment_checked" class="cursor"> <i class="icofont icofont-checked text-gray fs-26 "></i> </span>
                                    <span *ngIf="row.is_payment_checked"> <i class="icofont icofont-checked text-success fs-26 "></i> </span>
                                  </ng-template>
                                  </ngx-datatable-column>

                                  <ngx-datatable-column [cellClass]="'text-center '" [width]="210" name="Payment Finally Checked" [draggable]="false"
                                  [sortable]="false">
                                  <ng-template let-row="row" ngx-datatable-cell-template>
                                    <span  *ngIf="!row.is_payment_checked && !row.is_payment_checked_finally" > <i class="icofont icofont-checked text-gray fs-26"></i> </span>
                                    <span (click)="paymentCheck(row,2)" *ngIf="row.is_payment_checked && !row.is_payment_checked_finally" class="cursor"> <i class="icofont icofont-checked text-gray fs-26"></i> </span>
                                    <span *ngIf="row.is_payment_checked_finally"> <i class="icofont icofont-checked text-success fs-26"></i> </span>
                                  </ng-template>
                                  </ngx-datatable-column>

                                  <ngx-datatable-column [width]="170" name="Paid On" prop="created_at" [draggable]="false"
                                      [sortable]="false">
                                      <ng-template let-value="value" ngx-datatable-cell-template>
                                          <span >   {{value | amLocal | amDateFormat:'DD-MMM-YYYY, h:mm a'}} </span>
                                      </ng-template>
                                  </ngx-datatable-column>

                              </ngx-datatable>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>


    <!-- <ng-template #template>
      <div class="modal-header ">
        <h4 class="modal-title pull-left " id="modalTitle">  </h4>
        <button type="button " class="close pull-right " aria-label="Close " (click)="modalHide()">
          <i class="icofont icofont-close"></i>
        </button>
      </div>
      <div class="modal-body pb-0" *ngIf="billItem">
        <app-card>
          <div class="table-responsive">
            <table class="table table-styling">
              <thead>
                <tr class="table-primary" *ngIf="billItem.bill_type == 'Subscription'">
                  <th>Subscription:</th>
                  <th *ngIf="billItem.subscription">{{billItem.subscription.id}}</th>
                  <th>Session:</th>
                  <th>{{billItem.session}}</th>
                </tr>
              </thead>
            </table>
          </div>

          <div class="table-responsive" *ngIf="balanceObj">
            <table class="table">
              <thead>
                <tr>
                  <th width="60%">{{balanceObj.first_name}} {{balanceObj.last_name}}</th>
                  <th>Balance:</th>
                  <th>{{balance - tempPaidAmount}}</th>
                </tr>
              </thead>
            </table>
          </div>


          <table class="table table-xs ">
            <tbody>
              <tr>
                <th>Sub-Total </th>
                <th width="40%" class="text-right pr-4">{{subTotal}}</th>
              </tr>
              <tr>
                <th>So Far Paid </th>
                <th width="40%" class="text-right pr-4">{{billItem.so_far_paid}}</th>
              </tr>
              <tr>
                <th>Total Refunded </th>
                <th width="40%" class="text-right pr-4">{{billItem.parent_refund_amount}}</th>
              </tr>


              <tr class="table-info" style="font-size: 20px;">
                <th> Payable Amount </th>
                <th class="text-right pr-4">{{subTotal - (billItem.so_far_paid - billItem.parent_refund_amount)}}</th>
              </tr>
              <tr>
                <th>Paid Amount</th>
                <td class="pr-1">
                  <input [disabled]="isPayBalanceEnable" type="text" class="form-control form-control-sm text-right pr-3"
                    numeric numericType="number" (change)="onChangePaid(paidAmount)" [(ngModel)]="paidAmount"
                    [ngModelOptions]="{standalone: true}">
                </td>
              </tr>
              <tr *ngIf="isPayBalanceEnableShow">
                <th colspan="2">
                  <div class="form-group text-left">
                    <div class="checkbox-fade fade-in-primary">
                      <label>
                        <input type="checkbox" (change)="onChangePayBalance($event.target.checked)">
                        <span class="cr">
                          <i class="cr-icon icofont icofont-ui-check txt-primary"></i>
                        </span> Pay From Balance ?
                      </label>
                    </div>
                  </div>
                </th>

              </tr>
            </tbody>
          </table>
          <div class="form-group row">
            <label class="col-sm-4 col-form-label font-weight-bold pl-5">Remarks</label>
            <div class="col-sm-8">
              <textarea rows="2" type="text" [(ngModel)]="remarks" class="form-control"> </textarea>
            </div>
          </div>

        </app-card>
      </div>
      <div class="modal-footer">
        <div class="pr-4">
          <button class="btn btn-danger btn-sm btn-outline-danger mr-2" (click)="modalHide()"> <i
              class="icofont icofont-close"></i> Close</button>

          <button class="btn btn-success btn-outline-success btn-sm" (click)="onFormSubmit()"><i
              class="icofont icofont-check-circled"></i> {{btnSaveText}}</button>
        </div>

      </div>
    </ng-template> -->


</block-ui>
